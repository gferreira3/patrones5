https://www.codeproject.com/Tips/830060/Refactor-to-Functions
